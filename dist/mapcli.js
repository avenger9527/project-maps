var e=require("cac"),t=require("fs/promises"),r=require("path"),a=require("filesize");function s(e){return e&&e.__esModule?e.default:e}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},c={},i={},n=o.parcelRequire0bdd;null==n&&((n=function(e){if(e in c)return c[e].exports;if(e in i){var t=i[e];delete i[e];var r={id:e,exports:{}};return c[e]=r,t.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},o.parcelRequire0bdd=n);const l={exclude:["node_modules"],relativepathDesc:{".git":{desc:"git workspace",collapsed:!0},".husky":{desc:"husky workspace",collapsed:!0},".vscode":{desc:"vscode config",collapsed:!0},dist:{desc:"",collapsed:!0},"yarn.lock":{desc:"yarn package lock file",collapsed:!0}}},p=async e=>{console.log("hello",__filename,__dirname);const a=s(r).relative(__dirname,__filename.replace(/mapcli\.js/g,"chart.js"));console.log("chartJsPath",a);const o=`\n  <!DOCTYPE html>\n  <html lang="en">\n    <head>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n      <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n      <title>Project-Maps</title>\n      <style>\n        * {\n          padding: 0;\n          margin: 0;\n        }\n      </style>\n    </head>\n    <body>\n      <div style="width: 100vw; height: 100vh; display: flex">\n        <div id="container" style="flex: 1"></div>\n      </div>\n      <script src="./projectMaps.tree.js"><\/script>\n      <script src="./${a}"><\/script>\n    </body>\n  </html>\n\n  `;try{await s(t).writeFile(s(r).resolve(e,"projectMaps.views.html"),o),console.log("write-projectMaps.views.html.js-success")}catch(e){console.error("write-projectMaps.views.html.js-error",e)}},d=async e=>{const a=u(),o=a?{exclude:[...new Set(a.exclude.concat(l.exclude))],relativepathDesc:[...new Set([...Object.keys(l.relativepathDesc),...Object.keys(a.relativepathDesc)])].reduce(((e,t)=>{var r,s;return e[t]=Object.assign({},null!==(r=a.relativepathDesc[t])&&void 0!==r?r:{},null!==(s=l.relativepathDesc[t])&&void 0!==s?s:{}),e}),{})}:l;try{await s(t).writeFile(s(r).resolve(e,"projectMaps.config.js"),"module.exports = "+JSON.stringify(o,null,2)),console.log("write-projectMaps.config.js-success")}catch(e){console.error("write-projectMaps.config.js-error",e)}};const u=()=>{try{return require(s(r).resolve(__dirname,"projectMaps.config.js"))}catch(e){return console.error("getUserConfig-error,use default config"),l}},h=async(e,o,c,i)=>{let n=await s(t).readdir(s(r).resolve(e));n=n.filter((e=>!o.exclude.includes(e))),await Promise.all(n.map((async n=>{var l,p;const d=s(r).resolve(e,n),u=s(r).relative(__dirname,d);var m;const v=null!==(m=null===(l=o.relativepathDesc[u])||void 0===l?void 0:l.desc)&&void 0!==m?m:"";var g;const y=null!==(g=null===(p=o.relativepathDesc[u])||void 0===p?void 0:p.collapsed)&&void 0!==g?g:"",f=await s(t).stat(d),j=f.isDirectory();var w;i[n]=function(e,t,r,a,s,o,c){const i={parentName:e,fullPath:t,relativePath:r,size:a,desc:s,collapsed:c};return o&&(i.children={}),i}(c,d,u,s(a)(f.size),v,j,y),j&&await h(d,o,n,null!==(w=i[n].children)&&void 0!==w?w:{})})))},m=async e=>{const a={},o=u();try{await h(e,o,"root",a),await s(t).writeFile(s(r).resolve(e,"projectMaps.tree.js"),"window.projectMapsTree = "+JSON.stringify(a,null,2)),console.log("write-projectMaps.tree.js-success")}catch(e){console.log("write-projectMaps.tree.js-error",e)}},v=e.cac("project-maps");v.command("init [root]").action((async()=>{d(__dirname).finally((()=>{}))})),v.command("tree [root]").action((async()=>{console.log("call-tree"),m(__dirname).finally((()=>{}))})),v.command("generate [root]").action((async()=>{console.log("call-generate"),p(__dirname).finally((()=>{}))})),v.command("map").action((async()=>{console.log("call-map"),await d(__dirname),await m(__dirname),await p(__dirname)})),v.help(),n.register("4pejK",(function(e,t){e.exports=JSON.parse('{"name":"project-maps","version":"1.0.0","description":"visualize your project","bin":{"project-maps":"./bin/project-maps.js"},"files":["dist/"],"engines":{"node":">= 12"},"mapcli":"dist/mapcli.js","chart":"dist/chart.js","targets":{"mapcli":{"sourceMap":false,"source":"src/main.ts","engines":{"node":">= 12"}},"chart":{"sourceMap":false,"source":"src/chart.ts","engines":{"browsers":"> 0.5%, last 2 versions, not dead"}}},"scripts":{"build":"parcel build --no-cache","build:mapcli":"parcel build --target mapcli --no-cache","build:chart":"parcel build --target chart --no-cache"},"repository":{"type":"git","url":"https://github.com/toSayNothing/project-maps.git"},"keywords":["visualize","project","maps"],"author":"toSayNothing","license":"MIT","bugs":{"url":"https://github.com/toSayNothing/project-maps/issues"},"homepage":"https://github.com/toSayNothing/project-maps#readme","devDependencies":{"@parcel/packager-ts":"^2.0.1","@parcel/transformer-typescript-types":"^2.0.1","@types/node":"^17.0.4","parcel":"^2.0.1","typescript":">=3.0.0"},"dependencies":{"cac":"^6.7.12","chalk":"^5.0.0","echarts":"^5.2.2","filesize":"^8.0.6","vscode-icons-js":"^11.6.1"}}')})),v.version(n("4pejK").version),v.parse();